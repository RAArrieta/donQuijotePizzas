<h3 class="carro-titulo-producto">Productos</h3>
<div class="form-selects-conteiner">
    <form class="form-selects" id="form-productos">
        {% csrf_token %}
        {% for categoria, productos in categorias.items %}
            <div class="select-container">
                <select class="selects" name="producto" id="producto_{{ forloop.counter }}" onchange="deseleccionarOtrosYEnviar(event)">
                    <option disabled selected>{{ categoria }}</option>
                    {% for producto in productos %}
                        {% if producto.precio_doc %}
                            <option value="{{ producto.id }}">{{ producto.nombre }} c/u: ${{ producto.precio_unit }} | 1/2: ${{ producto.precio_media }} | Doc: ${{ producto.precio_doc }} </option>
                        {% elif producto.precio_media and not producto.precio_doc%}
                            <option value="{{ producto.id }}">{{ producto.nombre }} 1/2: ${{ producto.precio_media }} | c/u: ${{ producto.precio_unit }}</option>
                        {% else %}
                            <option value="{{ producto.id }}">{{ producto.nombre }} c/u: ${{ producto.precio_unit }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
        {% endfor %}

        <h3 class="carro-titulo-producto">Datos</h3>
            {% csrf_token %}
            {% for key, value in request.session.carro.items %}
                {% if key == "datos" %}
                    
                    <div class="form-selects-conteiner">
                        <div class="select-container">
                            <input type="text" {% if value.direccion == "" %}placeholder="Dirección..."{% else %}value="{{ value.direccion }}"{% endif %} name="direccion">
                            <input type="text" {% if value.nombre == "" %}placeholder="Nombre..."{% else %}value="{{ value.nombre }}"{% endif %} name="nombre">
                            <input type="text" {% if value.observacion == "" %}placeholder="Observación..."{% else %}value="{{ value.observacion }}"{% endif %} name="observacion">
                            <select name="estado">
                                <option value="pendiente" {% if value.estado == "pendiente" %}selected{% endif %}>PENDIENTE</option>
                                <option value="entregado" {% if value.estado == "entregado" %}selected{% endif %}>ENTREGADO</option>
                                <option value="cancelado" {% if value.estado == "cancelado" %}selected{% endif %}>CANCELADO</option>
                            </select>
                            <select name="pago">
                                <option value="cobrar" {% if value.pago == "cobrar" %}selected{% endif %}>COBRAR</option>
                                <option value="efectivo" {% if value.pago == "efectivo" %}selected{% endif %}>EFT</option>
                                <option value="mercado" {% if value.pago == "mercado" %}selected{% endif %}>MP</option>
                                <option value="naranja" {% if value.pago == "naranja" %}selected{% endif %}>NRJ</option>
                                <option value="debito" {% if value.pago == "debito" %}selected{% endif %}>DEBIT</option>
                            </select>    
                            <select name="forma_entrega">
                                <option value="retira" {% if value.forma_entrega == "retira" %}selected{% endif %}>RETIRA</option>
                                <option value="envio" {% if value.forma_entrega == "envio" %}selected{% endif %}>ENVIO</option>
                            </select>
                        </div>
                                 
                    </div>
                    
                {% endif %}
                
            {% endfor %}
            
            <button type="submit" name="cargar_pedido">cargar pedido</button>
            
    </form>
     
</div>

<script>
    const selects = document.querySelectorAll('.selects');

    function deseleccionarOtrosYEnviar(event) {
        const selectActual = event.target;
        
        selects.forEach(select => {
            if (select !== selectActual) {
                select.selectedIndex = 0;
            }
        });

        document.getElementById('form-productos').submit();
    }
</script>


